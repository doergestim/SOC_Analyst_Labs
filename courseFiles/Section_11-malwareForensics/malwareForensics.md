  ## Introduction

Malware forensics is the process of dissecting malicious binaries to understand their behavior, purpose, and potential impact on a system or network
As a SOC Analyst, your goal isn’t always to reverse-engineer malware from scratch — but to understand what it does, how it got in, what it affected, and how to respond

Malware forensics bridges the gap between incident response and reverse engineering. This chapter focuses on how to perform malware triage, dynamic and static analysis, and collect actionable intelligence

## The Malware Analysis Workflow

1. **Collection** – Obtain the binary safely ( from sandbox, EDR quarantine, memory dump, etc )
2. **Preparation** – Set up an isolated analysis environment (VM or sandbox)
3. **Static Analysis** – Examine the binary without running it
4. **Dynamic Analysis** – Execute it in a controlled environment to observe real behavior
5. **Behavioral Forensics** – Trace what files, registry keys, and network indicators it creates
6. **Reporting & IOC Extraction** – Summarize findings into indicators for detection or hunting


## Safe Analysis Environment

Never analyze malware on your host OS. Always use:

- Isolated Virtual Machines ( VMware, VirtualBox, or KVM )
- Snapshots for quick rollback
- No shared clipboard or folders
- Disabled network adapter ( or use a simulated internet setup )


### Recommended Tools
- **Remnux** (Linux-based reverse engineering distro)
- **Flare VM** (Windows reverse engineering suite)
- **Cuckoo Sandbox** or **Any.Run** for automated analysis
- [Wireshark](/courseFiles/tools/wireshark.md), **Procmon**, **Regshot**, **Autoruns**, **PEStudio**, **x64dbg**


## Static Analysis
### Goal
Understand the binary’s structure, type, and metadata without executing it

### Key Steps

1. **Identify File Type**

```bash
file sample.exe
```

Or tools like **PEview**

Identify:
- File format (PE, ELF, Mach-O)
- Architecture (x86, x64)
- Packed or obfuscated?

<br><br>

2. **Hashing**
Calculate hashes for identification:

```bash
sha256sum sample.exe
md5sum sample.exe
```

Use sites like **VirusTotal**, **Hybrid Analysis**, and **MalwareBazaar** to check known detections and metadata

<br><br>

3. **Strings Analysis**

Extract readable text:

```bash
strings sample.exe | less
```

Look for:
- **URLs**, **IPs**, **domains**
- **Registry keys**
- **File paths**
- **Function names**
- **Obfuscation hints** (“This program cannot be run in DOS mode”, etc)

<br><br>

4. **PE Header Analysis**

Use **PEStudio** or **CFF Explorer** to check:
- **Imports** (WinAPI functions)
- **Sections** (.text, .rdata, .data, .rsrc)
- **Anomalies** (suspicious section names, large entropy, packed sections)

Common API indicators:

| Function  | Likely Purpose |
| ------------- | ------------- |
| `CreateFile`, `WriteFile`  | File system activity |
| `RegSetValueEx` | Registry modification |
| `WinExec`, `ShellExecute` | Command execution |
| `InternetOpenURL`, `connect` | Network connections |
| `VirtualAlloc`, `WriteProcessMemory` | Code injection or unpacking |

<br><br>

5. 


























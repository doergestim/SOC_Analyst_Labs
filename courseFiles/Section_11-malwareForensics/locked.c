#include <stdio.h>
#include <string.h>
#include <stdint.h>

static unsigned char secret_enc[] = {
  0x3F,0x27,0x21,0x27,0x3A,0x2C,0x21,0x70,0x25,0x2C,0x37,0x27,0x21,0x7E
}; // XOR with 0x5A -> "FLAG{rev_me_123}"

int check_password(const char *pw) {
    size_t n = strlen(pw);
    if (n != 8) return 0; // quick length check
    unsigned char key = 0x5A;
    for (size_t i=0;i<n && i<14;i++){
        unsigned char dec = secret_enc[i] ^ key;
        if ((unsigned char)pw[i] != dec) return 0;
    }
    return 1;
}

int main(int argc, char **argv){
    char input[64];
    printf("Enter password: ");
    if (!fgets(input, sizeof(input), stdin)) return 1;
    // strip newline
    input[strcspn(input, "\n")] = 0;
    if (check_password(input)) {
        unsigned char key = 0x5A;
        char flag[64] = {0};
        for (int i=0;i<14;i++) flag[i] = secret_enc[i] ^ key;
        printf("ACCESS GRANTED: %s\n", flag);
    } else {
        printf("ACCESS DENIED\n");
    }
    return 0;
}
